{"version":3,"file":"index.js","sources":["../../src/utils/config.js","../../src/core/Transaction.js","../../src/widget/PayButton.jsx","../../src/widget/Dialog.jsx","../../src/core/TokenSelector.js","../../src/contexts/NetworkContext.jsx","../../src/widget/NetworkDropdown.jsx","../../src/widget/TokenDropdown.jsx","../../src/contexts/chains.js","../../src/contexts/WalletContext.jsx","../../src/widget/TransactionReview.jsx","../../src/widget/Widget.jsx","../../src/index.js","../../src/core/NetworkSelector.js","../../src/core/MerchantConfig.js"],"sourcesContent":["/**\r\n * Final Generalized Configuration\r\n * Supports multiple Djed deployments (Osiris, Isis, Tefnut) per network.\r\n */\r\nexport const networksConfig = {\r\n  'sepolia': {\r\n    uri: 'https://ethereum-sepolia.publicnode.com/',\r\n    chainId: 11155111,\r\n    stablecoins: [\r\n      {\r\n        id: 'djed-eth-sepolia',\r\n        name: 'Djed (ETH Backed)',\r\n        protocol: 'djed',\r\n        contractAddress: '0x624FcD0a1F9B5820c950FefD48087531d38387f4',\r\n        baseAsset: {\r\n          symbol: 'ETH',\r\n          decimals: 18,\r\n          isNative: true,\r\n          address: null\r\n        },\r\n        stableCoin: {\r\n          symbol: 'SOD',\r\n          address: '0x6b930182787F346F18666D167e8d32166dC5eFBD',\r\n          decimals: 18,\r\n          isDirectTransfer: true\r\n        }\r\n      }\r\n    ],\r\n    feeUI: 0\r\n  },\r\n  'milkomeda-mainnet': {\r\n    uri: 'https://rpc-mainnet-cardano-evm.c1.milkomeda.com',\r\n    chainId: 2001,\r\n    stablecoins: [\r\n      {\r\n        id: 'djed-mada',\r\n        name: 'Djed (mADA Backed)',\r\n        protocol: 'djed',\r\n        contractAddress: '0x67A30B399F5Ed499C1a6Bc0358FA6e42Ea4BCe76',\r\n        baseAsset: {\r\n          symbol: 'mADA',\r\n          decimals: 18,\r\n          isNative: true,\r\n          address: null\r\n        },\r\n        stableCoin: {\r\n          symbol: 'MOD',\r\n          address: '0xcbA90fB1003b9D1bc6a2b66257D2585011b004e9',\r\n          decimals: 18,\r\n          isDirectTransfer: true\r\n        }\r\n      },\r\n      {\r\n        id: 'djed-usdt-isis',\r\n        name: 'Djed (USDT Backed)',\r\n        protocol: 'isis', // Triggers ERC20 Approval logic\r\n        contractAddress: '0x0000000000000000000000000000000000000000', // Replace with live Isis address\r\n        baseAsset: { \r\n          symbol: 'USDT', \r\n          decimals: 6, \r\n          isNative: false, \r\n          address: '0x0000000000000000000000000000000000000000' // Replace with live USDT address\r\n        },\r\n        stableCoin: {\r\n          symbol: 'iUSD',\r\n          address: '0x0000000000000000000000000000000000000000',\r\n          decimals: 18,\r\n          isDirectTransfer: true\r\n        }\r\n      }\r\n    ],\r\n    feeUI: 0\r\n  },\r\n  'ethereum-classic': {\r\n    uri: 'https://etc.rivet.link',\r\n    chainId: 61,\r\n    stablecoins: [\r\n      {\r\n        id: 'djed-etc',\r\n        name: 'Djed (ETC Backed)',\r\n        protocol: 'djed',\r\n        contractAddress: '0xCc3664d7021FD36B1Fe2b136e2324710c8442cCf',\r\n        baseAsset: {\r\n          symbol: 'ETC',\r\n          decimals: 18,\r\n          isNative: true,\r\n          address: null\r\n        },\r\n        stableCoin: {\r\n          symbol: 'ECSD',\r\n          address: '0x5A7Ca94F6E969C94bef4CE5e2f90ed9d4891918A',\r\n          decimals: 18,\r\n          isDirectTransfer: true\r\n        }\r\n      }\r\n    ],\r\n    feeUI: 0\r\n  }\r\n};","import { \r\n  getWeb3, \r\n  getDjedContract, \r\n  getCoinContracts, \r\n  getDecimals, \r\n  getOracleAddress, \r\n  getOracleContract, \r\n  tradeDataPriceBuySc, \r\n  buyScTx, \r\n  buyScIsisTx, \r\n  checkAllowance, \r\n  approveTx \r\n} from 'djed-sdk';\r\nimport coinArtifact from 'djed-sdk/src/artifacts/CoinABI.json'; \r\n\r\nexport class Transaction {\r\n  /**\r\n   * @param {string} networkUri\r\n   * @param {object} stablecoinConfig - The specific config object for the selected stablecoin\r\n   */\r\n  constructor(networkUri, stablecoinConfig) {\r\n    this.networkUri = networkUri;\r\n    this.config = stablecoinConfig;\r\n    this.djedAddress = stablecoinConfig.contractAddress;\r\n    this.baseAsset = stablecoinConfig.baseAsset;\r\n  }\r\n\r\n  async init() {\r\n    if (!this.networkUri || !this.djedAddress) {\r\n      throw new Error('Network URI and DJED address are required');\r\n    }\r\n\r\n    try {\r\n      this.web3 = await getWeb3(this.networkUri);\r\n      this.djedContract = getDjedContract(this.web3, this.djedAddress);\r\n\r\n      // Initialize Base Asset contract if it is ERC20\r\n      if (!this.baseAsset.isNative && this.baseAsset.address) {\r\n        this.baseAssetContract = new this.web3.eth.Contract(coinArtifact.abi, this.baseAsset.address);\r\n      }\r\n      \r\n      try {\r\n        const { stableCoin, reserveCoin } = await getCoinContracts(this.djedContract, this.web3);\r\n        const { scDecimals, rcDecimals } = await getDecimals(stableCoin, reserveCoin);\r\n        this.stableCoin = stableCoin;\r\n        this.reserveCoin = reserveCoin;\r\n        this.scDecimals = scDecimals;\r\n        this.rcDecimals = rcDecimals;\r\n\r\n        this.oracleContract = await getOracleAddress(this.djedContract).then((addr) =>\r\n          getOracleContract(this.web3, addr, this.djedContract._address)\r\n        );\r\n\r\n        this.oracleAddress = this.oracleContract._address;\r\n      } catch (contractError) {\r\n        console.error('[Transaction] Error fetching contract details:', contractError);\r\n        throw contractError;\r\n      }\r\n    } catch (error) {\r\n      console.error('[Transaction] Error initializing transaction:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  getBlockchainDetails() {\r\n    return {\r\n      web3Available: !!this.web3,\r\n      djedContractAvailable: !!this.djedContract,\r\n      stableCoinAddress: this.stableCoin ? this.stableCoin._address : 'N/A',\r\n      reserveCoinAddress: this.reserveCoin ? this.reserveCoin._address : 'N/A',\r\n      stableCoinDecimals: this.scDecimals,\r\n      reserveCoinDecimals: this.rcDecimals,\r\n      oracleAddress: this.oracleAddress || 'N/A',\r\n      oracleContractAvailable: !!this.oracleContract,\r\n      baseAssetSymbol: this.baseAsset.symbol,\r\n      baseAssetIsNative: this.baseAsset.isNative,\r\n      baseAssetDecimals: this.baseAsset.decimals\r\n    };\r\n  }\r\n\r\n  async handleTradeDataBuySc(amountScaled) {\r\n    if (!this.djedContract) throw new Error(\"DJED contract is not initialized\");\r\n    try {\r\n      const result = await tradeDataPriceBuySc(this.djedContract, this.scDecimals, amountScaled);\r\n      return result.totalBCScaled;\r\n    } catch (error) {\r\n      console.error(\"Error fetching trade data for buying stablecoins: \", error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async buyStablecoins(payer, receiver, value) {\r\n    if (!this.djedContract) throw new Error(\"DJED contract is not initialized\");\r\n    \r\n    try {\r\n      const UI = '0x0232556C83791b8291E9b23BfEa7d67405Bd9839';\r\n\r\n      if (!this.baseAsset.isNative) {\r\n        // Use Isis transaction builder for ERC20\r\n        if (!this.baseAssetContract) throw new Error(\"Base Asset contract not initialized for ERC20 flow\");\r\n        return buyScIsisTx(this.djedContract, payer, receiver, value, UI, this.djedAddress);\r\n      } else {\r\n        // Use Standard transaction builder for Native\r\n        return buyScTx(this.djedContract, payer, receiver, value, UI, this.djedAddress);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error executing buyStablecoins transaction: \", error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async approveBaseAsset(payer, amount) {\r\n    if (this.baseAsset.isNative) throw new Error(\"Cannot approve native asset\");\r\n    if (!this.baseAssetContract) throw new Error(\"No Base Asset contract to approve\");\r\n    \r\n    return approveTx(this.baseAssetContract, payer, this.djedAddress, amount);\r\n  }\r\n\r\n  async checkBaseAssetAllowance(owner, amount) {\r\n     if (this.baseAsset.isNative) return true;\r\n     if (!this.baseAssetContract) return false;\r\n     \r\n     const allowance = await checkAllowance(this.baseAssetContract, owner, this.djedAddress);\r\n     return BigInt(allowance) >= BigInt(amount);\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport styles from \"../styles/main.css\";\r\n\r\nconst PayButton = ({ onClick, size = \"medium\" }) => {\r\n  const sizeStyles = {\r\n    small: { width: \"200px\", height: \"50px\", fontSize: \"14px\" },\r\n    medium: { width: \"250px\", height: \"60px\", fontSize: \"16px\" },\r\n    large: { width: \"300px\", height: \"70px\", fontSize: \"18px\" },\r\n  };\r\n\r\n  const logoSizes = {\r\n    small: { width: \"35px\", height: \"33px\" },\r\n    medium: { width: \"40px\", height: \"38px\" },\r\n    large: { width: \"45px\", height: \"43px\" },\r\n  };\r\n\r\n  const buttonStyle = sizeStyles[size] || sizeStyles.medium;\r\n  const logoStyle = logoSizes[size] || logoSizes.medium;\r\n\r\n  return (\r\n    <button\r\n      className={styles.stablePayButton}\r\n      onClick={onClick}\r\n      style={buttonStyle}\r\n    >\r\n      <div className={styles.logo} style={logoStyle} />\r\n      <span className={styles.buttonText}>Pay with StablePay</span>\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default PayButton;\r\n","import React from 'react';\r\nimport styles from '../styles/PricingCard.css';\r\n\r\n\r\nconst Dialog = ({ children, onClose, size = 'medium' }) => {\r\n  return (\r\n    <div className={styles.dialogOverlay}>\r\n      <div className={`${styles.pricingCard} ${styles[size]}`}>\r\n        <button className={styles.dialogClose} onClick={onClose}>×</button>\r\n        <div className={styles.pricingCardHeader}>\r\n        <div className={styles.allianceLogo}></div>\r\n\r\n          <h2 className={styles.stablepayTitle}>StablePay</h2>\r\n        </div>\r\n        <div className={styles.pricingCardBody}>\r\n          {children}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Dialog;","export class TokenSelector {\r\n  constructor(networkSelector) {\r\n    this.networkSelector = networkSelector;\r\n    this.selectedToken = null;\r\n  }\r\n\r\n  selectToken(tokenKey) {\r\n    const tokens = this.getAvailableTokens();\r\n    const foundToken = tokens.find(t => t.key === tokenKey);\r\n\r\n    if (foundToken) {\r\n      this.selectedToken = foundToken;\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  getSelectedToken() {\r\n    return this.selectedToken;\r\n  }\r\n\r\n  getAvailableTokens() {\r\n    const networkConfig = this.networkSelector.getSelectedNetworkConfig();\r\n    if (!networkConfig || !networkConfig.stablecoins) return [];\r\n\r\n    // Map the stablecoins array to the UI format\r\n    return networkConfig.stablecoins.map(sc => ({\r\n      key: sc.id,\r\n      name: sc.name,\r\n      symbol: sc.stableCoin.symbol,\r\n      baseAsset: sc.baseAsset.symbol,\r\n      isDirectTransfer: sc.stableCoin.isDirectTransfer,\r\n      // Store full config for Transaction usage\r\n      config: sc \r\n    }));\r\n  }\r\n\r\n  resetSelection() {\r\n    this.selectedToken = null;\r\n  }\r\n}\r\n","import React, { createContext, useState, useContext, useEffect } from 'react';\r\nimport { TokenSelector } from '../core/TokenSelector';\r\n\r\nconst NetworkContext = createContext();\r\n\r\nexport const NetworkProvider = ({ children, networkSelector }) => {\r\n  const [tokenSelector] = useState(() => new TokenSelector(networkSelector));\r\n  const [selectedNetwork, setSelectedNetwork] = useState(null);\r\n  const [selectedToken, setSelectedToken] = useState(null);\r\n  const [transactionDetails, setTransactionDetails] = useState(null);\r\n\r\n  const resetState = () => {\r\n    setSelectedToken(null);\r\n    setTransactionDetails(null);\r\n  };\r\n\r\n  const selectNetwork = (networkKey) => {\r\n    if (networkSelector.selectNetwork(networkKey)) {\r\n      setSelectedNetwork(networkKey);\r\n      resetState(); \r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  const selectToken = (tokenKey) => {\r\n    if (tokenSelector.selectToken(tokenKey)) {\r\n      const token = tokenSelector.getSelectedToken();\r\n      setSelectedToken(token);\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  const resetSelections = () => {\r\n    networkSelector.selectNetwork(null);\r\n    setSelectedNetwork(null);\r\n    resetState();\r\n  };\r\n\r\n  // Synchronize context state with NetworkSelector\r\n  useEffect(() => {\r\n    setSelectedNetwork(networkSelector.selectedNetwork);\r\n  }, [networkSelector.selectedNetwork]);\r\n\r\n  return (\r\n    <NetworkContext.Provider value={{ \r\n      networkSelector,\r\n      tokenSelector,\r\n      selectedNetwork,\r\n      selectedToken,\r\n      transactionDetails,\r\n      setTransactionDetails,\r\n      selectNetwork,\r\n      selectToken,\r\n      resetSelections\r\n    }}>\r\n      {children}\r\n    </NetworkContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useNetwork = () => {\r\n  const context = useContext(NetworkContext);\r\n  if (context === undefined) {\r\n    throw new Error('useNetwork must be used within a NetworkProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\nexport default NetworkContext;","import React from 'react';\r\nimport { useNetwork } from '../contexts/NetworkContext';\r\nimport styles from '../styles/PricingCard.css';\r\n\r\nconst NetworkDropdown = () => {\r\n  const { networkSelector, selectedNetwork, selectNetwork } = useNetwork();\r\n\r\n  const handleNetworkChange = (event) => {\r\n    selectNetwork(event.target.value);\r\n  };\r\n\r\n  return (\r\n    <div className={styles.selectField}>\r\n      <label htmlFor=\"network-select\">Select Network</label>\r\n      <select \r\n        id=\"network-select\"\r\n        onChange={handleNetworkChange} \r\n        value={selectedNetwork || \"\"}\r\n      >\r\n        <option value=\"\" disabled>Select a network</option>\r\n        {Object.keys(networkSelector.availableNetworks).map((networkKey) => (\r\n          <option key={networkKey} value={networkKey}>{networkKey}</option>\r\n        ))}\r\n      </select>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NetworkDropdown;","import React, { useState } from \"react\";\r\nimport { useNetwork } from \"../contexts/NetworkContext\";\r\nimport { Transaction } from \"../core/Transaction\";\r\nimport styles from \"../styles/PricingCard.css\";\r\n\r\nconst TokenDropdown = () => {\r\n  const {\r\n    networkSelector,\r\n    tokenSelector,\r\n    selectedNetwork,\r\n    selectedToken,\r\n    selectToken,\r\n    setTransactionDetails,\r\n  } = useNetwork();\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n const handleTokenChange = async (event) => {\r\n    const newValue = event.target.value; // e.g., 'djed-eth'\r\n    setError(null);\r\n    setLoading(true);\r\n\r\n    try {\r\n      if (selectToken(newValue)) {\r\n        const networkConfig = networkSelector.getSelectedNetworkConfig();\r\n        \r\n        // Find the specific stablecoin object matching the selected ID\r\n        const selectedStablecoin = networkConfig.stablecoins.find(\r\n          (sc) => sc.id === newValue\r\n        );\r\n\r\n        if (!selectedStablecoin) {\r\n          throw new Error(\"Stablecoin configuration not found\");\r\n        }\r\n\r\n        // Pass the full stablecoin object (replaces the removed djedAddress)\r\n        const transaction = new Transaction(\r\n          networkConfig.uri,\r\n          selectedStablecoin \r\n        );\r\n        await transaction.init();\r\n\r\n        const tokenAmount = networkSelector.getTokenAmount(newValue); \r\n        const blockchainDetails = transaction.getBlockchainDetails();\r\n\r\n        setTransactionDetails({\r\n          network: selectedNetwork,\r\n          token: newValue,\r\n          tokenSymbol: selectedStablecoin.stableCoin.symbol,\r\n          amount: tokenAmount,\r\n          receivingAddress: networkSelector.getReceivingAddress(),\r\n          \r\n          // Use properties from the selected stablecoin object\r\n          djedContractAddress: selectedStablecoin.contractAddress,\r\n          isDirectTransfer: selectedStablecoin.stableCoin.isDirectTransfer || false,\r\n          baseAssetSymbol: selectedStablecoin.baseAsset.symbol,\r\n          baseAssetDecimals: selectedStablecoin.baseAsset.decimals,\r\n          baseAssetIsNative: selectedStablecoin.baseAsset.isNative,\r\n          ...blockchainDetails,\r\n        });\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error updating transaction details:\", err);\r\n      setError(\"Failed to initialize transaction.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const availableTokens = selectedNetwork\r\n    ? tokenSelector.getAvailableTokens()\r\n    : [];\r\n\r\n  return (\r\n    <div className={styles.selectField}>\r\n      <label htmlFor=\"token-select\">Select Token</label>\r\n      <select\r\n        id=\"token-select\"\r\n        onChange={handleTokenChange}\r\n        value={selectedToken ? selectedToken.key : \"\"}\r\n        disabled={!selectedNetwork || loading}\r\n      >\r\n        <option value=\"\" disabled>\r\n          {selectedNetwork\r\n            ? loading\r\n              ? \"Loading...\"\r\n              : \"Select a token\"\r\n            : \"Please select a network first\"}\r\n        </option>\r\n        {availableTokens.map((token) => (\r\n          <option key={token.key} value={token.key}>\r\n            {token.symbol} (\r\n            {token.isDirectTransfer ? \"Direct Transfer\" : \"Native\"})\r\n          </option>\r\n        ))}\r\n      </select>\r\n      {error && <div className={styles.error}>{error}</div>}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TokenDropdown;\r\n","import { defineChain } from 'viem';\r\nimport { sepolia } from 'viem/chains';\r\n\r\nexport const mordor = defineChain({\r\n  id: 63,\r\n  name: 'Mordor Testnet',\r\n  network: 'mordor',\r\n  nativeCurrency: {\r\n    decimals: 18,\r\n    name: 'Mordor Ether',\r\n    symbol: 'METC',\r\n  },\r\n  rpcUrls: {\r\n    default: {\r\n      http: ['https://rpc.mordor.etccooperative.org'],\r\n      webSocket: ['wss://rpc.mordor.etccooperative.org/ws'],\r\n    },\r\n  },\r\n  blockExplorers: {\r\n    default: { name: 'BlockScout', url: 'https://blockscout.com/etc/mordor' },\r\n  },\r\n  testnet: true,\r\n});\r\n\r\nexport const milkomeda = defineChain({\r\n  id: 2001,\r\n  name: 'Milkomeda C1 Mainnet',\r\n  network: 'milkomeda',\r\n  nativeCurrency: {\r\n    decimals: 18,\r\n    name: 'Milkomeda ADA',\r\n    symbol: 'mADA',\r\n  },\r\n  rpcUrls: {\r\n    default: {\r\n      http: ['https://rpc-mainnet-cardano-evm.c1.milkomeda.com'],\r\n    },\r\n  },\r\n  blockExplorers: {\r\n    default: { name: 'Milkomeda Explorer', url: 'https://explorer-mainnet-cardano-evm.c1.milkomeda.com' },\r\n  },\r\n  testnet: false,\r\n});\r\n\r\nexport const etcMainnet = defineChain({\r\n  id: 61,\r\n  name: 'Ethereum Classic',\r\n  network: 'etc',\r\n  nativeCurrency: {\r\n    decimals: 18,\r\n    name: 'Ethereum Classic',\r\n    symbol: 'ETC',\r\n  },\r\n  rpcUrls: {\r\n    default: {\r\n      http: ['https://etc.rivet.link'],\r\n    },\r\n  },\r\n  blockExplorers: {\r\n    default: { name: 'Blockscout', url: 'https://blockscout.com/etc/mainnet' },\r\n  },\r\n  testnet: false,\r\n});\r\n\r\nexport const getChainByNetworkKey = (networkKey) => {\r\n  switch (networkKey) {\r\n    case 'sepolia':\r\n      return sepolia;\r\n    case 'ethereum-classic':\r\n      return etcMainnet;\r\n    case 'milkomeda-mainnet':\r\n      return milkomeda;\r\n    default:\r\n      return null;\r\n  }\r\n};\r\n\r\nexport const getChainConfigForWallet = (networkKey) => {\r\n  switch (networkKey) {\r\n    case 'sepolia':\r\n      return {\r\n        chainId: `0x${sepolia.id.toString(16)}`,\r\n        chainName: 'Sepolia',\r\n        nativeCurrency: {\r\n          name: 'Ether',\r\n          symbol: 'ETH',\r\n          decimals: 18,\r\n        },\r\n        rpcUrls: sepolia.rpcUrls.default.http,\r\n        blockExplorerUrls: sepolia.blockExplorers?.default?.url ? [sepolia.blockExplorers.default.url] : [],\r\n      };\r\n    case 'ethereum-classic':\r\n      return {\r\n        chainId: `0x${etcMainnet.id.toString(16)}`,\r\n        chainName: 'Ethereum Classic',\r\n        nativeCurrency: {\r\n          name: 'Ethereum Classic',\r\n          symbol: 'ETC',\r\n          decimals: 18,\r\n        },\r\n        rpcUrls: ['https://etc.rivet.link'],\r\n        blockExplorerUrls: ['https://blockscout.com/etc/mainnet'],\r\n      };\r\n    case 'milkomeda-mainnet':\r\n      return {\r\n        chainId: `0x${milkomeda.id.toString(16)}`,\r\n        chainName: 'Milkomeda C1 Mainnet',\r\n        nativeCurrency: {\r\n          name: 'Milkomeda ADA',\r\n          symbol: 'mADA',\r\n          decimals: 18,\r\n        },\r\n        rpcUrls: ['https://rpc-mainnet-cardano-evm.c1.milkomeda.com'],\r\n        blockExplorerUrls: ['https://explorer-mainnet-cardano-evm.c1.milkomeda.com'],\r\n      };\r\n    default:\r\n      return null;\r\n  }\r\n};\r\n","import React, { createContext, useContext, useState, useCallback, useEffect, useRef } from 'react';\r\nimport { createWalletClient, createPublicClient, custom, http } from 'viem';\r\nimport { useNetwork } from './NetworkContext';\r\nimport { getChainByNetworkKey, getChainConfigForWallet } from './chains';\r\n\r\nconst WalletContext = createContext(null);\r\n\r\nexport const useWallet = () => {\r\n  const context = useContext(WalletContext);\r\n  if (!context) {\r\n    throw new Error('useWallet must be used within a WalletProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\nconst switchToNetwork = async (networkKey) => {\r\n  if (!window.ethereum) {\r\n    throw new Error('MetaMask not installed');\r\n  }\r\n\r\n  const chainConfig = getChainConfigForWallet(networkKey);\r\n  if (!chainConfig) {\r\n    throw new Error(`Unsupported network: ${networkKey}`);\r\n  }\r\n\r\n  try {\r\n    await window.ethereum.request({\r\n      method: 'wallet_switchEthereumChain',\r\n      params: [{ chainId: chainConfig.chainId }],\r\n    });\r\n  } catch (switchError) {\r\n    if (switchError.code === 4902) {\r\n      try {\r\n        await window.ethereum.request({\r\n          method: 'wallet_addEthereumChain',\r\n          params: [chainConfig],\r\n        });\r\n      } catch (addError) {\r\n        if (addError.code === 4001) {\r\n          throw new Error(`User rejected adding ${chainConfig.chainName} to MetaMask. Please add it manually.`);\r\n        }\r\n        throw new Error(`Failed to add ${chainConfig.chainName} to MetaMask: ${addError.message}`);\r\n      }\r\n    } else if (switchError.code === 4001) {\r\n      throw new Error(`User rejected switching to ${chainConfig.chainName}. Please switch manually in MetaMask.`);\r\n    } else {\r\n      throw new Error(`Failed to switch to ${chainConfig.chainName}: ${switchError.message}`);\r\n    }\r\n  }\r\n};\r\n\r\nexport const WalletProvider = ({ children }) => {\r\n  const { selectedNetwork } = useNetwork();\r\n  const [walletClient, setWalletClient] = useState(null);\r\n  const [publicClient, setPublicClient] = useState(null);\r\n  const [account, setAccount] = useState(null);\r\n  const [chainId, setChainId] = useState(null);\r\n  const [balance, setBalance] = useState(null);\r\n  const [error, setError] = useState(null);\r\n  const [isConnecting, setIsConnecting] = useState(false);\r\n\r\n  const selectedChain = selectedNetwork ? getChainByNetworkKey(selectedNetwork) : null;\r\n  const expectedChainId = selectedChain ? selectedChain.id : null;\r\n\r\n  const handleAccountsChangedRef = useRef(null);\r\n  const handleChainChangedRef = useRef(null);\r\n\r\n  const disconnectWalletInternal = useCallback(() => {\r\n    setWalletClient(null);\r\n    setPublicClient(null);\r\n    setAccount(null);\r\n    setChainId(null);\r\n    setBalance(null);\r\n    setError(null);\r\n  }, []);\r\n\r\n  const handleChainChanged = useCallback(async (chainIdHex) => {\r\n    const newChainId = parseInt(chainIdHex, 16);\r\n    setChainId(newChainId);\r\n\r\n    if (selectedChain && newChainId === expectedChainId) {\r\n      setError(null);\r\n      if (window.ethereum && selectedChain) {\r\n        const newWalletClient = createWalletClient({ \r\n          chain: selectedChain, \r\n          transport: custom(window.ethereum) \r\n        });\r\n        setWalletClient(newWalletClient);\r\n      }\r\n    } else if (selectedChain && newChainId !== expectedChainId) {\r\n      const chainName = selectedChain?.name || selectedNetwork || 'selected network';\r\n      setError(`Wrong network detected. Please switch to ${chainName}`);\r\n    }\r\n  }, [selectedChain, expectedChainId, selectedNetwork]);\r\n\r\n  handleChainChangedRef.current = handleChainChanged;\r\n\r\n  const handleAccountsChanged = useCallback(async (accounts) => {\r\n    if (accounts.length === 0) {\r\n      disconnectWalletInternal();\r\n      if (window.ethereum) {\r\n        const accountsHandler = handleAccountsChangedRef.current;\r\n        const chainHandler = handleChainChangedRef.current;\r\n        if (accountsHandler) {\r\n          window.ethereum.removeListener('accountsChanged', accountsHandler);\r\n        }\r\n        if (chainHandler) {\r\n          window.ethereum.removeListener('chainChanged', chainHandler);\r\n        }\r\n      }\r\n    } else {\r\n      setAccount(accounts[0]);\r\n      if (selectedChain) {\r\n        try {\r\n          const newPublicClient = createPublicClient({ chain: selectedChain, transport: http() });\r\n          setPublicClient(newPublicClient);\r\n          const balance = await newPublicClient.getBalance({ address: accounts[0] });\r\n          setBalance(parseFloat(balance) / Math.pow(10, 18));\r\n        } catch (error) {\r\n          console.error('Error fetching balance:', error);\r\n          setBalance(null);\r\n        }\r\n      }\r\n    }\r\n  }, [selectedChain, disconnectWalletInternal]);\r\n\r\n  handleAccountsChangedRef.current = handleAccountsChanged;\r\n\r\n  const disconnectWallet = useCallback(() => {\r\n    disconnectWalletInternal();\r\n    if (window.ethereum) {\r\n      const accountsHandler = handleAccountsChangedRef.current;\r\n      const chainHandler = handleChainChangedRef.current;\r\n      if (accountsHandler) {\r\n        window.ethereum.removeListener('accountsChanged', accountsHandler);\r\n      }\r\n      if (chainHandler) {\r\n        window.ethereum.removeListener('chainChanged', chainHandler);\r\n      }\r\n    }\r\n  }, [disconnectWalletInternal]);\r\n\r\n  const connectPublicClient = useCallback(() => {\r\n    if (selectedChain) {\r\n      setPublicClient(createPublicClient({ chain: selectedChain, transport: http() }));\r\n    }\r\n  }, [selectedChain]);\r\n\r\n  const connectWallet = useCallback(async () => {\r\n    if (!window.ethereum) {\r\n      setError('Please install MetaMask or another Web3 wallet');\r\n      return false;\r\n    }\r\n\r\n    if (!selectedNetwork || !selectedChain) {\r\n      setError('Please select a network first');\r\n      return false;\r\n    }\r\n\r\n    setIsConnecting(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const accounts = await window.ethereum.request({ \r\n        method: 'eth_requestAccounts' \r\n      });\r\n\r\n      if (accounts.length === 0) {\r\n        throw new Error('No wallet address found. Please unlock your wallet.');\r\n      }\r\n\r\n      const chainIdHex = await window.ethereum.request({ method: 'eth_chainId' });\r\n      const currentChainId = parseInt(chainIdHex, 16);\r\n\r\n      if (currentChainId !== expectedChainId) {\r\n        await switchToNetwork(selectedNetwork);\r\n      }\r\n\r\n      const newWalletClient = createWalletClient({\r\n        chain: selectedChain,\r\n        transport: custom(window.ethereum),\r\n      });\r\n\r\n      setWalletClient(newWalletClient);\r\n      setAccount(accounts[0]);\r\n      setChainId(expectedChainId);\r\n\r\n      const newPublicClient = createPublicClient({ chain: selectedChain, transport: http() });\r\n      setPublicClient(newPublicClient);\r\n      try {\r\n        const balance = await newPublicClient.getBalance({ address: accounts[0] });\r\n        setBalance(parseFloat(balance) / Math.pow(10, 18));\r\n      } catch (error) {\r\n        console.error('Error fetching balance:', error);\r\n        setBalance(null);\r\n      }\r\n\r\n      handleAccountsChangedRef.current = handleAccountsChanged;\r\n      handleChainChangedRef.current = handleChainChanged;\r\n      window.ethereum.on('accountsChanged', handleAccountsChanged);\r\n      window.ethereum.on('chainChanged', handleChainChanged);\r\n\r\n      return true;\r\n    } catch (err) {\r\n      console.error('Error connecting wallet:', err);\r\n      setError(err.message);\r\n      return false;\r\n    } finally {\r\n      setIsConnecting(false);\r\n    }\r\n  }, [selectedNetwork, selectedChain, expectedChainId, handleAccountsChanged, handleChainChanged]);\r\n\r\n  const ensureCorrectNetwork = useCallback(async () => {\r\n    if (!window.ethereum || !selectedNetwork || !selectedChain || !account) {\r\n      const errorMsg = 'Wallet not connected or network not selected';\r\n      setError(errorMsg);\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      const chainIdHex = await window.ethereum.request({ method: 'eth_chainId' });\r\n      const currentChainId = parseInt(chainIdHex, 16);\r\n\r\n      if (currentChainId !== expectedChainId) {\r\n        setError(null);\r\n        await switchToNetwork(selectedNetwork);\r\n        const NETWORK_SWITCH_DELAY_MS = 500;\r\n        await new Promise(resolve => setTimeout(resolve, NETWORK_SWITCH_DELAY_MS));\r\n        \r\n        const newChainIdHex = await window.ethereum.request({ method: 'eth_chainId' });\r\n        const newChainId = parseInt(newChainIdHex, 16);\r\n        if (newChainId !== expectedChainId) {\r\n          throw new Error(`Failed to switch network. MetaMask is still on chain ${newChainId}, expected ${expectedChainId}`);\r\n        }\r\n      }\r\n\r\n      const freshWalletClient = createWalletClient({\r\n        chain: selectedChain,\r\n        transport: custom(window.ethereum),\r\n      });\r\n\r\n      setWalletClient(freshWalletClient);\r\n      setChainId(expectedChainId);\r\n      setError(null);\r\n      return freshWalletClient;\r\n    } catch (err) {\r\n      setError(err.message);\r\n      return null;\r\n    }\r\n  }, [selectedNetwork, selectedChain, expectedChainId, account]);\r\n\r\n  const prevNetworkRef = useRef(selectedNetwork);\r\n\r\n  useEffect(() => {\r\n    if (prevNetworkRef.current !== null && \r\n        prevNetworkRef.current !== selectedNetwork && \r\n        account) {\r\n      disconnectWalletInternal();\r\n      if (window.ethereum) {\r\n        const accountsHandler = handleAccountsChangedRef.current;\r\n        const chainHandler = handleChainChangedRef.current;\r\n        if (accountsHandler) {\r\n          window.ethereum.removeListener('accountsChanged', accountsHandler);\r\n        }\r\n        if (chainHandler) {\r\n          window.ethereum.removeListener('chainChanged', chainHandler);\r\n        }\r\n      }\r\n    }\r\n    prevNetworkRef.current = selectedNetwork;\r\n  }, [selectedNetwork, account, disconnectWalletInternal]);\r\n\r\n  useEffect(() => {\r\n    connectPublicClient();\r\n  }, [connectPublicClient]);\r\n\r\n  return (\r\n    <WalletContext.Provider\r\n      value={{\r\n        walletClient,\r\n        publicClient,\r\n        account,\r\n        chainId,\r\n        balance,\r\n        error,\r\n        isConnecting,\r\n        connectWallet,\r\n        disconnectWallet,\r\n        ensureCorrectNetwork,\r\n        expectedChainId,\r\n      }}\r\n    >\r\n      {children}\r\n    </WalletContext.Provider>\r\n  );\r\n};","import React, { useState, useEffect } from \"react\";\r\nimport { useNetwork } from \"../contexts/NetworkContext\";\r\nimport { useWallet } from \"../contexts/WalletContext\";\r\nimport { Transaction } from \"../core/Transaction\";\r\nimport { parseUnits } from \"viem\"; \r\nimport styles from \"../styles/PricingCard.css\"; \r\n\r\nconst TransactionReview = ({ onTransactionComplete }) => {\r\n  const {\r\n    networkSelector,\r\n    tokenSelector,\r\n    selectedNetwork,\r\n    selectedToken,\r\n    transactionDetails: contextTransactionDetails,\r\n    setTransactionDetails,\r\n  } = useNetwork();\r\n\r\n  const {\r\n    connectWallet,\r\n    account,\r\n    walletClient,\r\n    ensureCorrectNetwork,\r\n    isConnecting,\r\n  } = useWallet();\r\n\r\n  const [transaction, setTransaction] = useState(null);\r\n  const [txData, setTxData] = useState(null);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [txHash, setTxHash] = useState(null);\r\n  const [error, setError] = useState(null);\r\n  const [isErrorDetailsVisible, setIsErrorDetailsVisible] = useState(false);\r\n  \r\n  // Approval States\r\n  const [isApproved, setIsApproved] = useState(false);\r\n  const [isApproving, setIsApproving] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setTxData(null);\r\n    setMessage(\"\");\r\n    setError(null);\r\n    setTxHash(null);\r\n    setIsApproved(false);\r\n  }, [selectedNetwork, selectedToken]);\r\n\r\n  useEffect(() => {\r\n    const initializeTransaction = async () => {\r\n      if (!selectedNetwork || !selectedToken) return;\r\n\r\n      try {\r\n        const networkConfig = networkSelector.getSelectedNetworkConfig();\r\n        const selectedTokenObj = tokenSelector.getSelectedToken();\r\n        const stablecoinConfig = selectedTokenObj.config;\r\n        \r\n        const newTransaction = new Transaction(\r\n          networkConfig.uri,\r\n          stablecoinConfig\r\n        );\r\n        \r\n        await newTransaction.init();\r\n        setTransaction(newTransaction);\r\n\r\n        const tokenAmount = networkSelector.getTokenAmount(selectedToken.key);\r\n        let tradeDataAmount = null;\r\n\r\n        try {\r\n            tradeDataAmount = await newTransaction.handleTradeDataBuySc(String(tokenAmount));\r\n        } catch (tradeError) {\r\n            console.error(\"Error fetching trade data:\", tradeError);\r\n        }\r\n\r\n        setTransactionDetails({\r\n          network: selectedNetwork,\r\n          token: selectedToken.key,\r\n          tokenSymbol: selectedToken.symbol,\r\n          amount: tokenAmount || \"0\",\r\n          receivingAddress: networkSelector.getReceivingAddress(),\r\n          tradeAmount: tradeDataAmount, \r\n          ...newTransaction.getBlockchainDetails(),\r\n        });\r\n        \r\n        if (account) {\r\n            if (!stablecoinConfig.baseAsset.isNative && tradeDataAmount) {\r\n                 checkAllowance(newTransaction, account, tradeDataAmount, stablecoinConfig.baseAsset.decimals);\r\n            } else if (stablecoinConfig.baseAsset.isNative) {\r\n                 setIsApproved(true);\r\n            }\r\n        }\r\n\r\n      } catch (err) {\r\n        console.error(\"Error initializing transaction:\", err);\r\n      }\r\n    };\r\n\r\n    initializeTransaction();\r\n  }, [selectedNetwork, selectedToken, networkSelector, account]); \r\n\r\n  const checkAllowance = async (txInstance, userAccount, amountStr, decimals) => {\r\n      try {\r\n          const amountBigInt = parseUnits(String(amountStr), decimals);\r\n          const hasAllowance = await txInstance.checkBaseAssetAllowance(userAccount, amountBigInt);\r\n          setIsApproved(hasAllowance);\r\n      } catch (e) {\r\n          console.error(\"Error checking allowance\", e);\r\n      }\r\n  };\r\n\r\n  const handleConnectWallet = async () => {\r\n    await connectWallet();\r\n  };\r\n  \r\n  const handleApprove = async () => {\r\n      if (!transaction || !account) return;\r\n      setIsApproving(true);\r\n      setMessage(\"⏳ Approving token usage...\");\r\n      try {\r\n          const { tradeAmount, baseAssetDecimals } = contextTransactionDetails;\r\n          const amount = parseUnits(String(tradeAmount), baseAssetDecimals);\r\n          \r\n          const approveData = await transaction.approveBaseAsset(account, amount);\r\n          const freshWalletClient = await ensureCorrectNetwork();\r\n          \r\n          const hash = await freshWalletClient.sendTransaction({\r\n             ...approveData,\r\n             account\r\n          });\r\n          \r\n          setMessage(`⏳ Approval Sent. Waiting...`);\r\n          \r\n         \r\n          const receipt = await walletClient.waitForTransactionReceipt({ hash });\r\n            if (receipt.status === 'success') {\r\n                setIsApproved(true);\r\n                setMessage(\"✅ Approved! You can now send the payment.\");\r\n            } else {\r\n                setMessage(\"❌ Approval transaction failed on-chain.\");\r\n            }\r\n          setIsApproving(false);\r\n          \r\n      } catch(e) {\r\n          console.error(e);\r\n          setError(e);\r\n          setMessage(\"❌ Approval failed.\");\r\n          setIsApproving(false);\r\n      }\r\n  };\r\n\r\n  const handlePrepareTransaction = async () => {\r\n    if (!account || !transaction) return;\r\n\r\n    try {\r\n      setTxData(null);\r\n      setError(null);\r\n      setMessage(\"⏳ Preparing transaction...\");\r\n\r\n      const { tradeAmount, receivingAddress, baseAssetDecimals, baseAssetIsNative } = contextTransactionDetails;\r\n      const valueInUnits = parseUnits(String(tradeAmount), baseAssetDecimals);\r\n\r\n      const builtTx = await transaction.buyStablecoins(\r\n        account,\r\n        receivingAddress,\r\n        valueInUnits\r\n      );\r\n\r\n      const finalTx = { ...builtTx, account: account };\r\n      \r\n      if (baseAssetIsNative) {\r\n          finalTx.value = valueInUnits;\r\n      } else {\r\n          finalTx.value = 0n; // ERC20s send 0 value (uses data payload)\r\n      }\r\n\r\n      setTxData(finalTx);\r\n      setMessage(\"✅ Transaction ready! Click 'Send Transaction' to proceed.\");\r\n    } catch (error) {\r\n      setError(error);\r\n      setMessage(`❌ Transaction preparation failed.`);\r\n    }\r\n  };\r\n\r\n  const handleSendTransaction = async () => {\r\n    try {\r\n      if (!account || !txData) return;\r\n      \r\n      const freshWalletClient = await ensureCorrectNetwork();\r\n      setMessage(\"⏳ Sending transaction...\");\r\n      \r\n      const txHash = await freshWalletClient.sendTransaction(txData);\r\n\r\n      setTxHash(txHash);\r\n      setMessage(`✅ Transaction sent!`);\r\n      \r\n      if (onTransactionComplete) {\r\n        onTransactionComplete({\r\n          txHash,\r\n          network: selectedNetwork,\r\n          amount: contextTransactionDetails?.amount,\r\n        });\r\n      }\r\n    } catch (error) {\r\n      setError(error);\r\n      setMessage(`❌ Transaction failed.`);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={styles.transactionReview}>\r\n      <div className={styles.transactionInfo}>\r\n        <span className={styles.transactionLabel}>Network:</span>\r\n        <span className={styles.transactionValue}>{contextTransactionDetails.network}</span>\r\n      </div>\r\n\r\n      <div className={styles.transactionInfo}>\r\n        <span className={styles.transactionLabel}>You Pay:</span>\r\n        <span className={styles.transactionValue}>\r\n          {contextTransactionDetails.tradeAmount \r\n            ? `${contextTransactionDetails.tradeAmount} ${contextTransactionDetails.baseAssetSymbol}`\r\n            : \"Calculating...\"}\r\n        </span>\r\n      </div>\r\n\r\n      <button className={styles.walletButton} onClick={handleConnectWallet} disabled={isConnecting}>\r\n        {isConnecting ? \"Connecting...\" : account ? `Connected: ${account.slice(0,6)}...` : \"Connect Wallet\"}\r\n      </button>\r\n\r\n      {account && !contextTransactionDetails.baseAssetIsNative && !isApproved && (\r\n         <button className={styles.walletButton} onClick={handleApprove} disabled={isApproving}>\r\n            {isApproving ? \"Approving...\" : `Approve ${contextTransactionDetails.baseAssetSymbol}`}\r\n         </button>\r\n      )}\r\n\r\n      {account && (contextTransactionDetails.baseAssetIsNative || isApproved) && !txData && (\r\n        <button className={styles.walletButton} onClick={handlePrepareTransaction}>\r\n          Prepare Transaction\r\n        </button>\r\n      )}\r\n      \r\n      {account && txData && (\r\n        <button className={styles.walletButton} onClick={handleSendTransaction} disabled={txHash !== null}>\r\n          Send Transaction\r\n        </button>\r\n      )}\r\n\r\n      {message && <div className=\"message-box\">{message}</div>}\r\n      \r\n      {txHash && (\r\n        <div className={styles.transactionLink}>\r\n            ✅ Transaction Hash: {txHash.slice(0, 10)}...\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TransactionReview;\r\n","import React, { useState } from \"react\";\r\nimport PayButton from \"./PayButton\";\r\nimport Dialog from \"./Dialog\";\r\nimport NetworkDropdown from \"./NetworkDropdown\";\r\nimport TokenDropdown from \"./TokenDropdown\";\r\nimport TransactionReview from \"./TransactionReview\";\r\nimport { NetworkProvider, useNetwork } from \"../contexts/NetworkContext\";\r\nimport { WalletProvider } from \"../contexts/WalletContext\";\r\nimport styles from \"../styles/PricingCard.css\";\r\n\r\nconst WidgetContent = ({ onClose, buttonSize, onTransactionComplete }) => {\r\n  const { resetSelections } = useNetwork(); \r\n\r\n  const handleClose = () => {\r\n    resetSelections(); // Reset selections when closing the widget\r\n    onClose();\r\n  };\r\n\r\n  return (\r\n    <Dialog onClose={handleClose} size={buttonSize}>\r\n      <NetworkDropdown />\r\n      <TokenDropdown />\r\n      <TransactionReview onTransactionComplete={onTransactionComplete} />\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nconst WidgetWithProviders = ({ onClose, buttonSize, networkSelector, onTransactionComplete }) => {\r\n  return (\r\n    <NetworkProvider networkSelector={networkSelector}>\r\n      <WalletProvider> \r\n        <WidgetContent onClose={onClose} buttonSize={buttonSize} onTransactionComplete={onTransactionComplete} />\r\n      </WalletProvider>\r\n    </NetworkProvider>\r\n  );\r\n};\r\n\r\nexport const Widget = ({ networkSelector, buttonSize = \"medium\", onTransactionComplete, onSuccess }) => {\r\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\r\n\r\n  const handleOpenDialog = () => {\r\n    setIsDialogOpen(true);\r\n  };\r\n\r\n  const handleCloseDialog = () => {\r\n    setIsDialogOpen(false);\r\n  };\r\n\r\n  // Support both onTransactionComplete and onSuccess for backwards compatibility\r\n  const handleTransactionComplete = onTransactionComplete || onSuccess;\r\n\r\n  return (\r\n    <div className={styles.widgetContainer}>\r\n      {!isDialogOpen && (\r\n        <PayButton onClick={handleOpenDialog} size={buttonSize} />\r\n      )}\r\n      {isDialogOpen && (\r\n        <WidgetWithProviders\r\n          onClose={handleCloseDialog}\r\n          buttonSize={buttonSize}\r\n          networkSelector={networkSelector}\r\n          onTransactionComplete={handleTransactionComplete}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Widget;\r\n","// src/index.js\r\nimport { NetworkSelector } from './core/NetworkSelector';\r\nimport { Transaction } from './core/Transaction';\r\nimport { Config } from './core/MerchantConfig';\r\nimport Widget from './widget/Widget.jsx';\r\nimport PayButton from './widget/PayButton.jsx';\r\nimport Dialog from './widget/Dialog.jsx';\r\nimport NetworkDropdown from './widget/NetworkDropdown.jsx';\r\nimport './styles/main.css';\r\nimport './styles/PricingCard.css';\r\n\r\nconst StablePay = {\r\n  NetworkSelector,\r\n  Transaction,\r\n  Config,\r\n  Widget,\r\n  PayButton,\r\n  Dialog,\r\n  NetworkDropdown\r\n};\r\n\r\nexport default StablePay;","import { networksConfig } from \"../utils/config\";\r\n\r\nexport class NetworkSelector {\r\n  constructor(merchantConfig) {\r\n    this.merchantConfig = merchantConfig;\r\n    this.blacklist = merchantConfig.getBlacklist();\r\n    this.availableNetworks = this.getAvailableNetworks();\r\n    this.selectedNetwork = null;\r\n  }\r\n\r\n  getAvailableNetworks() {\r\n    return Object.entries(networksConfig).reduce(\r\n      (acc, [networkKey, networkConfig]) => {\r\n        if (!this.blacklist.includes(networkConfig.chainId)) {\r\n          acc[networkKey] = networkConfig;\r\n        }\r\n        return acc;\r\n      },\r\n      {}\r\n    );\r\n  }\r\n\r\n  selectNetwork(networkKey) {\r\n    if (networkKey === null) {\r\n      this.selectedNetwork = null;\r\n      console.log(\"Network selection reset\");\r\n      return true;\r\n    }\r\n    if (this.availableNetworks[networkKey]) {\r\n      this.selectedNetwork = networkKey;\r\n      console.log(`Network selected: ${networkKey}`);\r\n      return true;\r\n    }\r\n    console.error(`Invalid network: ${networkKey}`);\r\n    return false;\r\n  }\r\n\r\n  getSelectedNetworkConfig() {\r\n    return this.selectedNetwork\r\n      ? this.availableNetworks[this.selectedNetwork]\r\n      : null;\r\n  }\r\n\r\n  getReceivingAddress() {\r\n    return this.merchantConfig.getReceivingAddress();\r\n  }\r\n\r\n  // Updated to accept a specific token ID\r\n   getTokenAmount(network, tokenKey) {\r\n    console.log(\"Getting amount for network:\", network);\r\n    console.log(\"Amounts object:\", this.amounts);\r\n   const amount = this.amounts[network]?.[tokenKey] ?? this.amounts[network]?.stablecoin;\r\n    return amount || 0;\r\n  }\r\n}\r\n","import { networksConfig } from \"../utils/config\";\r\n\r\nexport class Config {\r\n  constructor(options = {}) {\r\n    this.receivingAddress = options.receivingAddress || \"\";\r\n    this.blacklist = options.blacklist || [];\r\n    this.amounts = options.Amounts || {}; // Note the capital 'A' in Amounts\r\n    this.validateConfig();\r\n  }\r\n\r\n  validateConfig() {\r\n    if (!this.receivingAddress) {\r\n      throw new Error(\"Receiving address is required\");\r\n    }\r\n    // Validate stablecoin amounts\r\n    for (const [network, tokens] of Object.entries(this.amounts)) {\r\n      if (!networksConfig[network]) {\r\n        throw new Error(`Invalid network: ${network}`);\r\n      }\r\n      if (\r\n        !tokens.stablecoin ||\r\n        typeof tokens.stablecoin !== \"number\" ||\r\n        tokens.stablecoin <= 0\r\n      ) {\r\n        throw new Error(`Invalid stablecoin amount for network ${network}`);\r\n      }\r\n    }\r\n  }\r\n\r\n  getBlacklist() {\r\n    return this.blacklist;\r\n  }\r\n\r\n  getReceivingAddress() {\r\n    return this.receivingAddress;\r\n  }\r\n\r\n  // getTokenAmount(network, token) {\r\n  //   const networkConfig = networksConfig[network];\r\n  //   if (!networkConfig) return 0;\r\n\r\n  //   const stablecoinSymbol = networkConfig.tokens.stablecoin.symbol;\r\n\r\n  //   if (token === 'stablecoin') {\r\n  //     return this.amounts[network]?.stablecoin || 0;\r\n  //   }\r\n  //   // For native tokens, return 0 as it's not specified in the new structure\r\n  //   return 0;\r\n  // }\r\n  getTokenAmount(network) {\r\n    console.log(\"Getting amount for network:\", network);\r\n    console.log(\"Amounts object:\", this.amounts);\r\n\r\n    // Directly return the stablecoin amount for the network\r\n    const amount = this.amounts[network]?.stablecoin;\r\n    console.log(\"Returning amount:\", amount);\r\n\r\n    return amount || 0;\r\n  }\r\n}\r\n\r\nexport default Config;\r\n"],"names":["networksConfig","sepolia","uri","chainId","stablecoins","id","name","protocol","contractAddress","baseAsset","symbol","decimals","isNative","address","stableCoin","isDirectTransfer","feeUI","Transaction","constructor","networkUri","stablecoinConfig","this","config","djedAddress","init","Error","web3","getWeb3","djedContract","getDjedContract","baseAssetContract","eth","Contract","coinArtifact","abi","reserveCoin","getCoinContracts","scDecimals","rcDecimals","getDecimals","oracleContract","getOracleAddress","then","addr","getOracleContract","_address","oracleAddress","contractError","console","error","getBlockchainDetails","web3Available","djedContractAvailable","stableCoinAddress","reserveCoinAddress","stableCoinDecimals","reserveCoinDecimals","oracleContractAvailable","baseAssetSymbol","baseAssetIsNative","baseAssetDecimals","handleTradeDataBuySc","amountScaled","tradeDataPriceBuySc","totalBCScaled","buyStablecoins","payer","receiver","value","UI","buyScTx","buyScIsisTx","approveBaseAsset","amount","approveTx","checkBaseAssetAllowance","owner","allowance","checkAllowance","BigInt","PayButton","onClick","size","sizeStyles","small","width","height","fontSize","medium","large","logoSizes","buttonStyle","logoStyle","React","createElement","className","styles","style","Dialog","children","onClose","dialogOverlay","pricingCard","dialogClose","pricingCardHeader","allianceLogo","stablepayTitle","pricingCardBody","TokenSelector","networkSelector","selectedToken","selectToken","tokenKey","foundToken","getAvailableTokens","find","t","key","getSelectedToken","networkConfig","getSelectedNetworkConfig","map","sc","resetSelection","NetworkContext","createContext","NetworkProvider","tokenSelector","useState","selectedNetwork","setSelectedNetwork","setSelectedToken","transactionDetails","setTransactionDetails","resetState","useEffect","Provider","selectNetwork","networkKey","token","resetSelections","useNetwork","context","useContext","undefined","NetworkDropdown","selectField","htmlFor","onChange","event","target","disabled","Object","keys","availableNetworks","TokenDropdown","loading","setLoading","setError","availableTokens","async","newValue","selectedStablecoin","transaction","tokenAmount","getTokenAmount","blockchainDetails","network","tokenSymbol","receivingAddress","getReceivingAddress","djedContractAddress","err","defineChain","nativeCurrency","rpcUrls","default","http","webSocket","blockExplorers","url","testnet","milkomeda","etcMainnet","WalletContext","switchToNetwork","window","ethereum","chainConfig","toString","chainName","blockExplorerUrls","getChainConfigForWallet","request","method","params","switchError","code","message","addError","WalletProvider","walletClient","setWalletClient","publicClient","setPublicClient","account","setAccount","setChainId","balance","setBalance","isConnecting","setIsConnecting","selectedChain","getChainByNetworkKey","expectedChainId","handleAccountsChangedRef","useRef","handleChainChangedRef","disconnectWalletInternal","useCallback","handleChainChanged","newChainId","parseInt","chainIdHex","newWalletClient","createWalletClient","chain","transport","custom","current","handleAccountsChanged","accounts","length","accountsHandler","chainHandler","removeListener","newPublicClient","createPublicClient","getBalance","parseFloat","Math","pow","disconnectWallet","connectPublicClient","connectWallet","on","ensureCorrectNetwork","NETWORK_SWITCH_DELAY_MS","Promise","resolve","setTimeout","newChainIdHex","freshWalletClient","prevNetworkRef","TransactionReview","onTransactionComplete","contextTransactionDetails","useWallet","setTransaction","txData","setTxData","setMessage","txHash","setTxHash","isApproved","setIsApproved","isApproving","setIsApproving","newTransaction","tradeDataAmount","String","tradeError","tradeAmount","initializeTransaction","txInstance","userAccount","amountStr","amountBigInt","parseUnits","hasAllowance","e","transactionReview","transactionInfo","transactionLabel","transactionValue","walletButton","slice","approveData","hash","sendTransaction","waitForTransactionReceipt","status","valueInUnits","finalTx","transactionLink","WidgetContent","buttonSize","handleClose","WidgetWithProviders","NetworkSelector","merchantConfig","blacklist","getBlacklist","getAvailableNetworks","entries","reduce","acc","includes","log","amounts","stablecoin","Config","options","Amounts","validateConfig","tokens","Widget","onSuccess","isDialogOpen","setIsDialogOpen","handleTransactionComplete","widgetContainer","handleOpenDialog","handleCloseDialog"],"mappings":"ifAIO,MAAMA,EAAiB,CAC5BC,QAAW,CACTC,IAAK,2CACLC,QAAS,SACTC,YAAa,CACX,CACEC,GAAI,mBACJC,KAAM,oBACNC,SAAU,OACVC,gBAAiB,6CACjBC,UAAW,CACTC,OAAQ,MACRC,SAAU,GACVC,UAAU,EACVC,QAAS,MAEXC,WAAY,CACVJ,OAAQ,MACRG,QAAS,6CACTF,SAAU,GACVI,kBAAkB,KAIxBC,MAAO,GAET,oBAAqB,CACnBd,IAAK,mDACLC,QAAS,KACTC,YAAa,CACX,CACEC,GAAI,YACJC,KAAM,qBACNC,SAAU,OACVC,gBAAiB,6CACjBC,UAAW,CACTC,OAAQ,OACRC,SAAU,GACVC,UAAU,EACVC,QAAS,MAEXC,WAAY,CACVJ,OAAQ,MACRG,QAAS,6CACTF,SAAU,GACVI,kBAAkB,IAGtB,CACEV,GAAI,iBACJC,KAAM,qBACNC,SAAU,OACVC,gBAAiB,6CACjBC,UAAW,CACTC,OAAQ,OACRC,SAAU,EACVC,UAAU,EACVC,QAAS,8CAEXC,WAAY,CACVJ,OAAQ,OACRG,QAAS,6CACTF,SAAU,GACVI,kBAAkB,KAIxBC,MAAO,GAET,mBAAoB,CAClBd,IAAK,yBACLC,QAAS,GACTC,YAAa,CACX,CACEC,GAAI,WACJC,KAAM,oBACNC,SAAU,OACVC,gBAAiB,6CACjBC,UAAW,CACTC,OAAQ,MACRC,SAAU,GACVC,UAAU,EACVC,QAAS,MAEXC,WAAY,CACVJ,OAAQ,OACRG,QAAS,6CACTF,SAAU,GACVI,kBAAkB,KAIxBC,MAAO,ICjFJ,MAAMC,EAKXC,WAAAA,CAAYC,EAAYC,GACtBC,KAAKF,WAAaA,EAClBE,KAAKC,OAASF,EACdC,KAAKE,YAAcH,EAAiBZ,gBACpCa,KAAKZ,UAAYW,EAAiBX,SACpC,CAEA,UAAMe,GACJ,IAAKH,KAAKF,aAAeE,KAAKE,YAC5B,MAAM,IAAIE,MAAM,6CAGlB,IACEJ,KAAKK,WAAaC,EAAOA,QAACN,KAAKF,YAC/BE,KAAKO,aAAeC,kBAAgBR,KAAKK,KAAML,KAAKE,cAG/CF,KAAKZ,UAAUG,UAAYS,KAAKZ,UAAUI,UAC7CQ,KAAKS,kBAAoB,IAAIT,KAAKK,KAAKK,IAAIC,SAASC,EAAaC,IAAKb,KAAKZ,UAAUI,UAGvF,IACE,MAAMC,WAAEA,EAAUqB,YAAEA,SAAsBC,EAAgBA,iBAACf,KAAKO,aAAcP,KAAKK,OAC7EW,WAAEA,EAAUC,WAAEA,SAAqBC,EAAWA,YAACzB,EAAYqB,GACjEd,KAAKP,WAAaA,EAClBO,KAAKc,YAAcA,EACnBd,KAAKgB,WAAaA,EAClBhB,KAAKiB,WAAaA,EAElBjB,KAAKmB,qBAAuBC,EAAAA,iBAAiBpB,KAAKO,cAAcc,MAAMC,GACpEC,EAAAA,kBAAkBvB,KAAKK,KAAMiB,EAAMtB,KAAKO,aAAaiB,YAGvDxB,KAAKyB,cAAgBzB,KAAKmB,eAAeK,QAC1C,CAAC,MAAOE,GAEP,MADAC,QAAQC,MAAM,iDAAkDF,GAC1DA,CACR,CACD,CAAC,MAAOE,GAEP,MADAD,QAAQC,MAAM,gDAAiDA,GACzDA,CACR,CACF,CAEAC,oBAAAA,GACE,MAAO,CACLC,gBAAiB9B,KAAKK,KACtB0B,wBAAyB/B,KAAKO,aAC9ByB,kBAAmBhC,KAAKP,WAAaO,KAAKP,WAAW+B,SAAW,MAChES,mBAAoBjC,KAAKc,YAAcd,KAAKc,YAAYU,SAAW,MACnEU,mBAAoBlC,KAAKgB,WACzBmB,oBAAqBnC,KAAKiB,WAC1BQ,cAAezB,KAAKyB,eAAiB,MACrCW,0BAA2BpC,KAAKmB,eAChCkB,gBAAiBrC,KAAKZ,UAAUC,OAChCiD,kBAAmBtC,KAAKZ,UAAUG,SAClCgD,kBAAmBvC,KAAKZ,UAAUE,SAEtC,CAEA,0BAAMkD,CAAqBC,GACzB,IAAKzC,KAAKO,aAAc,MAAM,IAAIH,MAAM,oCACxC,IAEE,aADqBsC,EAAAA,oBAAoB1C,KAAKO,aAAcP,KAAKgB,WAAYyB,IAC/DE,aACf,CAAC,MAAOf,GAEP,MADAD,QAAQC,MAAM,qDAAsDA,GAC9DA,CACR,CACF,CAEA,oBAAMgB,CAAeC,EAAOC,EAAUC,GACpC,IAAK/C,KAAKO,aAAc,MAAM,IAAIH,MAAM,oCAExC,IACE,MAAM4C,EAAK,6CAEX,GAAKhD,KAAKZ,UAAUG,SAMlB,OAAO0D,EAAOA,QAACjD,KAAKO,aAAcsC,EAAOC,EAAUC,EAAOC,EAAIhD,KAAKE,aAJnE,IAAKF,KAAKS,kBAAmB,MAAM,IAAIL,MAAM,sDAC7C,OAAO8C,EAAWA,YAAClD,KAAKO,aAAcsC,EAAOC,EAAUC,EAAOC,EAAIhD,KAAKE,YAK1E,CAAC,MAAO0B,GAEP,MADAD,QAAQC,MAAM,+CAAgDA,GACxDA,CACR,CACF,CAEA,sBAAMuB,CAAiBN,EAAOO,GAC5B,GAAIpD,KAAKZ,UAAUG,SAAU,MAAM,IAAIa,MAAM,+BAC7C,IAAKJ,KAAKS,kBAAmB,MAAM,IAAIL,MAAM,qCAE7C,OAAOiD,EAAAA,UAAUrD,KAAKS,kBAAmBoC,EAAO7C,KAAKE,YAAakD,EACpE,CAEA,6BAAME,CAAwBC,EAAOH,GAClC,GAAIpD,KAAKZ,UAAUG,SAAU,OAAO,EACpC,IAAKS,KAAKS,kBAAmB,OAAO,EAEpC,MAAM+C,QAAkBC,EAAAA,eAAezD,KAAKS,kBAAmB8C,EAAOvD,KAAKE,aAC3E,OAAOwD,OAAOF,IAAcE,OAAON,EACtC,sFCzHF,MAAMO,EAAYA,EAAGC,UAASC,OAAO,aACnC,MAAMC,EAAa,CACjBC,MAAO,CAAEC,MAAO,QAASC,OAAQ,OAAQC,SAAU,QACnDC,OAAQ,CAAEH,MAAO,QAASC,OAAQ,OAAQC,SAAU,QACpDE,MAAO,CAAEJ,MAAO,QAASC,OAAQ,OAAQC,SAAU,SAG/CG,EAAY,CAChBN,MAAO,CAAEC,MAAO,OAAQC,OAAQ,QAChCE,OAAQ,CAAEH,MAAO,OAAQC,OAAQ,QACjCG,MAAO,CAAEJ,MAAO,OAAQC,OAAQ,SAG5BK,EAAcR,EAAWD,IAASC,EAAWK,OAC7CI,EAAYF,EAAUR,IAASQ,EAAUF,OAE/C,OACEK,EAAAC,cAAA,SAAA,CACEC,UAAWC,EACXf,QAASA,EACTgB,MAAON,GAEPE,EAAAC,cAAA,MAAA,CAAKC,UAAWC,EAAaC,MAAOL,IACpCC,EAAAC,cAAA,OAAA,CAAMC,UAAWC,GAAmB,sBAC7B,qyCCvBb,MAAME,EAASA,EAAGC,WAAUC,UAASlB,OAAO,YAExCW,EAAAC,cAAA,MAAA,CAAKC,UAAWC,EAAOK,eACrBR,EAAAC,cAAA,MAAA,CAAKC,UAAW,GAAGC,EAAOM,eAAeN,EAAOd,MAC9CW,EAAAC,cAAA,SAAA,CAAQC,UAAWC,EAAOO,YAAatB,QAASmB,GAAS,KACzDP,EAAAC,cAAA,MAAA,CAAKC,UAAWC,EAAOQ,mBACvBX,EAAAC,cAAA,MAAA,CAAKC,UAAWC,EAAOS,eAErBZ,EAAAC,cAAA,KAAA,CAAIC,UAAWC,EAAOU,gBAAgB,cAExCb,EAAAC,cAAA,MAAA,CAAKC,UAAWC,EAAOW,iBACpBR,KCfJ,MAAMS,EACX1F,WAAAA,CAAY2F,GACVxF,KAAKwF,gBAAkBA,EACvBxF,KAAKyF,cAAgB,IACvB,CAEAC,WAAAA,CAAYC,GACV,MACMC,EADS5F,KAAK6F,qBACMC,MAAKC,GAAKA,EAAEC,MAAQL,IAE9C,QAAIC,IACF5F,KAAKyF,cAAgBG,GACd,EAGX,CAEAK,gBAAAA,GACE,OAAOjG,KAAKyF,aACd,CAEAI,kBAAAA,GACE,MAAMK,EAAgBlG,KAAKwF,gBAAgBW,2BAC3C,OAAKD,GAAkBA,EAAcnH,YAG9BmH,EAAcnH,YAAYqH,KAAIC,IAAO,CAC1CL,IAAKK,EAAGrH,GACRC,KAAMoH,EAAGpH,KACTI,OAAQgH,EAAG5G,WAAWJ,OACtBD,UAAWiH,EAAGjH,UAAUC,OACxBK,iBAAkB2G,EAAG5G,WAAWC,iBAEhCO,OAAQoG,MAV+C,EAY3D,CAEAC,cAAAA,GACEtG,KAAKyF,cAAgB,IACvB,ECpCF,MAAMc,EAAiBC,EAAaA,gBAEvBC,EAAkBA,EAAG3B,WAAUU,sBAC1C,MAAOkB,GAAiBC,EAAQA,UAAC,IAAM,IAAIpB,EAAcC,MAClDoB,EAAiBC,GAAsBF,EAAQA,SAAC,OAChDlB,EAAeqB,GAAoBH,EAAQA,SAAC,OAC5CI,EAAoBC,GAAyBL,EAAQA,SAAC,MAEvDM,EAAaA,KACjBH,EAAiB,MACjBE,EAAsB,KAAK,EAgC7B,OAJAE,EAAAA,WAAU,KACRL,EAAmBrB,EAAgBoB,gBAAgB,GAClD,CAACpB,EAAgBoB,kBAGlBpC,EAAAC,cAAC8B,EAAeY,SAAQ,CAACpE,MAAO,CAC9ByC,kBACAkB,gBACAE,kBACAnB,gBACAsB,qBACAC,wBACAI,cArCmBC,KACjB7B,EAAgB4B,cAAcC,KAChCR,EAAmBQ,GACnBJ,KACO,GAkCPvB,YA7BiBC,IACnB,GAAIe,EAAchB,YAAYC,GAAW,CACvC,MAAM2B,EAAQZ,EAAcT,mBAE5B,OADAa,EAAiBQ,IACV,CACT,CACA,OAAO,CAAK,EAwBVC,gBArBoBA,KACtB/B,EAAgB4B,cAAc,MAC9BP,EAAmB,MACnBI,GAAY,IAoBTnC,EACuB,EAIjB0C,EAAaA,KACxB,MAAMC,EAAUC,aAAWnB,GAC3B,QAAgBoB,IAAZF,EACF,MAAM,IAAIrH,MAAM,oDAElB,OAAOqH,CAAO,EC/DVG,EAAkBA,KACtB,MAAMpC,gBAAEA,EAAeoB,gBAAEA,EAAeQ,cAAEA,GAAkBI,IAM5D,OACEhD,EAAAC,cAAA,MAAA,CAAKC,UAAWC,EAAOkD,aACrBrD,EAAAC,cAAA,QAAA,CAAOqD,QAAQ,kBAAiB,kBAChCtD,EAAAC,cAAA,SAAA,CACEzF,GAAG,iBACH+I,SATuBC,IAC3BZ,EAAcY,EAAMC,OAAOlF,MAAM,EAS7BA,MAAO6D,GAAmB,IAE1BpC,EAAAC,cAAA,SAAA,CAAQ1B,MAAM,GAAGmF,UAAQ,GAAC,oBACzBC,OAAOC,KAAK5C,EAAgB6C,mBAAmBjC,KAAKiB,GACnD7C,EAAAC,cAAA,SAAA,CAAQuB,IAAKqB,EAAYtE,MAAOsE,GAAaA,MAG7C,ECnBJiB,EAAgBA,KACpB,MAAM9C,gBACJA,EAAekB,cACfA,EAAaE,gBACbA,EAAenB,cACfA,EAAaC,YACbA,EAAWsB,sBACXA,GACEQ,KAEGe,EAASC,GAAc7B,EAAQA,UAAC,IAChC/E,EAAO6G,GAAY9B,EAAQA,SAAC,MAsD7B+B,EAAkB9B,EACpBF,EAAcb,qBACd,GAEJ,OACErB,EAAAC,cAAA,MAAA,CAAKC,UAAWC,EAAOkD,aACrBrD,EAAAC,cAAA,QAAA,CAAOqD,QAAQ,gBAAe,gBAC9BtD,EAAAC,cAAA,SAAA,CACEzF,GAAG,eACH+I,SA7DmBY,UACvB,MAAMC,EAAWZ,EAAMC,OAAOlF,MAC9B0F,EAAS,MACTD,GAAW,GAEX,IACE,GAAI9C,EAAYkD,GAAW,CACzB,MAAM1C,EAAgBV,EAAgBW,2BAGhC0C,EAAqB3C,EAAcnH,YAAY+G,MAClDO,GAAOA,EAAGrH,KAAO4J,IAGpB,IAAKC,EACH,MAAM,IAAIzI,MAAM,sCAIlB,MAAM0I,EAAc,IAAIlJ,EACtBsG,EAAcrH,IACdgK,SAEIC,EAAY3I,OAElB,MAAM4I,EAAcvD,EAAgBwD,eAAeJ,GAC7CK,EAAoBH,EAAYjH,uBAEtCmF,EAAsB,CACpBkC,QAAStC,EACTU,MAAOsB,EACPO,YAAaN,EAAmBpJ,WAAWJ,OAC3C+D,OAAQ2F,EACRK,iBAAkB5D,EAAgB6D,sBAGlCC,oBAAqBT,EAAmB1J,gBACxCO,iBAAkBmJ,EAAmBpJ,WAAWC,mBAAoB,EACpE2C,gBAAiBwG,EAAmBzJ,UAAUC,OAC9CkD,kBAAmBsG,EAAmBzJ,UAAUE,SAChDgD,kBAAmBuG,EAAmBzJ,UAAUG,YAC7C0J,GAEP,CACD,CAAC,MAAOM,GACP5H,QAAQC,MAAM,sCAAuC2H,GACrDd,EAAS,oCACX,CAAU,QACRD,GAAW,EACb,GAaIzF,MAAO0C,EAAgBA,EAAcO,IAAM,GAC3CkC,UAAWtB,GAAmB2B,GAE9B/D,EAAAC,cAAA,SAAA,CAAQ1B,MAAM,GAAGmF,UAAQ,GACtBtB,EACG2B,EACE,aACA,iBACF,iCAELG,EAAgBtC,KAAKkB,GACpB9C,EAAAC,cAAA,SAAA,CAAQuB,IAAKsB,EAAMtB,IAAKjD,MAAOuE,EAAMtB,KAClCsB,EAAMjI,OAAO,KACbiI,EAAM5H,iBAAmB,kBAAoB,SAAS,QAI5DkC,GAAS4C,EAAAC,cAAA,MAAA,CAAKC,UAAWC,EAAO/C,OAAQA,GACrC,EC/FY4H,EAAAA,YAAY,CAChCxK,GAAI,GACJC,KAAM,iBACNiK,QAAS,SACTO,eAAgB,CACdnK,SAAU,GACVL,KAAM,eACNI,OAAQ,QAEVqK,QAAS,CACPC,QAAS,CACPC,KAAM,CAAC,yCACPC,UAAW,CAAC,4CAGhBC,eAAgB,CACdH,QAAS,CAAE1K,KAAM,aAAc8K,IAAK,sCAEtCC,SAAS,IAGJ,MAAMC,EAAYT,EAAAA,YAAY,CACnCxK,GAAI,KACJC,KAAM,uBACNiK,QAAS,YACTO,eAAgB,CACdnK,SAAU,GACVL,KAAM,gBACNI,OAAQ,QAEVqK,QAAS,CACPC,QAAS,CACPC,KAAM,CAAC,sDAGXE,eAAgB,CACdH,QAAS,CAAE1K,KAAM,qBAAsB8K,IAAK,0DAE9CC,SAAS,IAGEE,EAAaV,EAAAA,YAAY,CACpCxK,GAAI,GACJC,KAAM,mBACNiK,QAAS,MACTO,eAAgB,CACdnK,SAAU,GACVL,KAAM,mBACNI,OAAQ,OAEVqK,QAAS,CACPC,QAAS,CACPC,KAAM,CAAC,4BAGXE,eAAgB,CACdH,QAAS,CAAE1K,KAAM,aAAc8K,IAAK,uCAEtCC,SAAS,ICxDLG,EAAgB3D,EAAAA,cAAc,MAU9B4D,EAAkBzB,UACtB,IAAK0B,OAAOC,SACV,MAAM,IAAIlK,MAAM,0BAGlB,MAAMmK,EDyDgClD,KACtC,OAAQA,GACN,IAAK,UACH,MAAO,CACLvI,QAAS,KAAKF,EAAOA,QAACI,GAAGwL,SAAS,MAClCC,UAAW,UACXhB,eAAgB,CACdxK,KAAM,QACNI,OAAQ,MACRC,SAAU,IAEZoK,QAAS9K,EAAOA,QAAC8K,QAAQC,QAAQC,KACjCc,kBAAmB9L,EAAOA,QAACkL,gBAAgBH,SAASI,IAAM,CAACnL,EAAOA,QAACkL,eAAeH,QAAQI,KAAO,IAErG,IAAK,mBACH,MAAO,CACLjL,QAAS,KAAKoL,EAAWlL,GAAGwL,SAAS,MACrCC,UAAW,mBACXhB,eAAgB,CACdxK,KAAM,mBACNI,OAAQ,MACRC,SAAU,IAEZoK,QAAS,CAAC,0BACVgB,kBAAmB,CAAC,uCAExB,IAAK,oBACH,MAAO,CACL5L,QAAS,KAAKmL,EAAUjL,GAAGwL,SAAS,MACpCC,UAAW,uBACXhB,eAAgB,CACdxK,KAAM,gBACNI,OAAQ,OACRC,SAAU,IAEZoK,QAAS,CAAC,oDACVgB,kBAAmB,CAAC,0DAExB,QACE,OAAO,KACX,ECjGoBC,CAAwBtD,GAC5C,IAAKkD,EACH,MAAM,IAAInK,MAAM,wBAAwBiH,KAG1C,UACQgD,OAAOC,SAASM,QAAQ,CAC5BC,OAAQ,6BACRC,OAAQ,CAAC,CAAEhM,QAASyL,EAAYzL,WAEnC,CAAC,MAAOiM,GACP,GAAyB,OAArBA,EAAYC,KAYT,MAAyB,OAArBD,EAAYC,KACf,IAAI5K,MAAM,8BAA8BmK,EAAYE,kDAEpD,IAAIrK,MAAM,uBAAuBmK,EAAYE,cAAcM,EAAYE,WAd7E,UACQZ,OAAOC,SAASM,QAAQ,CAC5BC,OAAQ,0BACRC,OAAQ,CAACP,IAEZ,CAAC,MAAOW,GACP,GAAsB,OAAlBA,EAASF,KACX,MAAM,IAAI5K,MAAM,wBAAwBmK,EAAYE,kDAEtD,MAAM,IAAIrK,MAAM,iBAAiBmK,EAAYE,0BAA0BS,EAASD,UAClF,CAMJ,GAGWE,EAAiBA,EAAGrG,eAC/B,MAAM8B,gBAAEA,GAAoBY,KACrB4D,EAAcC,GAAmB1E,EAAQA,SAAC,OAC1C2E,EAAcC,GAAmB5E,EAAQA,SAAC,OAC1C6E,EAASC,GAAc9E,EAAQA,SAAC,OAChC7H,EAAS4M,GAAc/E,EAAQA,SAAC,OAChCgF,EAASC,GAAcjF,EAAQA,SAAC,OAChC/E,EAAO6G,GAAY9B,EAAQA,SAAC,OAC5BkF,EAAcC,GAAmBnF,EAAQA,UAAC,GAE3CoF,EAAgBnF,EDGaS,KACnC,OAAQA,GACN,IAAK,UACH,OAAOzI,UACT,IAAK,mBACH,OAAOsL,EACT,IAAK,oBACH,OAAOD,EACT,QACE,OAAO,KACX,ECbwC+B,CAAqBpF,GAAmB,KAC1EqF,EAAkBF,EAAgBA,EAAc/M,GAAK,KAErDkN,EAA2BC,SAAO,MAClCC,EAAwBD,SAAO,MAE/BE,EAA2BC,EAAAA,aAAY,KAC3CjB,EAAgB,MAChBE,EAAgB,MAChBE,EAAW,MACXC,EAAW,MACXE,EAAW,MACXnD,EAAS,KAAK,GACb,IAEG8D,EAAqBD,eAAY3D,UACrC,MAAM6D,EAAaC,SAASC,EAAY,IAGxC,GAFAhB,EAAWc,GAEPT,GAAiBS,IAAeP,GAElC,GADAxD,EAAS,MACL4B,OAAOC,UAAYyB,EAAe,CACpC,MAAMY,EAAkBC,EAAAA,mBAAmB,CACzCC,MAAOd,EACPe,UAAWC,EAAAA,OAAO1C,OAAOC,YAE3Be,EAAgBsB,EAClB,OACK,GAAIZ,GAAiBS,IAAeP,EAAiB,CAE1DxD,EAAS,4CADSsD,GAAe9M,MAAQ2H,GAAmB,qBAE9D,IACC,CAACmF,EAAeE,EAAiBrF,IAEpCwF,EAAsBY,QAAUT,EAEhC,MAAMU,EAAwBX,eAAY3D,UACxC,GAAwB,IAApBuE,EAASC,QAEX,GADAd,IACIhC,OAAOC,SAAU,CACnB,MAAM8C,EAAkBlB,EAAyBc,QAC3CK,EAAejB,EAAsBY,QACvCI,GACF/C,OAAOC,SAASgD,eAAe,kBAAmBF,GAEhDC,GACFhD,OAAOC,SAASgD,eAAe,eAAgBD,EAEnD,OAGA,GADA5B,EAAWyB,EAAS,IAChBnB,EACF,IACE,MAAMwB,EAAkBC,EAAAA,mBAAmB,CAAEX,MAAOd,EAAee,UAAWlD,EAAAA,SAC9E2B,EAAgBgC,GAChB,MAAM5B,QAAgB4B,EAAgBE,WAAW,CAAEjO,QAAS0N,EAAS,KACrEtB,EAAW8B,WAAW/B,GAAWgC,KAAKC,IAAI,GAAI,IAC/C,CAAC,MAAOhM,GACPD,QAAQC,MAAM,0BAA2BA,GACzCgK,EAAW,KACb,CAEJ,GACC,CAACG,EAAeM,IAEnBH,EAAyBc,QAAUC,EAEnC,MAAMY,EAAmBvB,EAAAA,aAAY,KAEnC,GADAD,IACIhC,OAAOC,SAAU,CACnB,MAAM8C,EAAkBlB,EAAyBc,QAC3CK,EAAejB,EAAsBY,QACvCI,GACF/C,OAAOC,SAASgD,eAAe,kBAAmBF,GAEhDC,GACFhD,OAAOC,SAASgD,eAAe,eAAgBD,EAEnD,IACC,CAAChB,IAEEyB,EAAsBxB,EAAAA,aAAY,KAClCP,GACFR,EAAgBiC,EAAAA,mBAAmB,CAAEX,MAAOd,EAAee,UAAWlD,EAAAA,SACxE,GACC,CAACmC,IAEEgC,EAAgBzB,EAAAA,aAAY3D,UAChC,IAAK0B,OAAOC,SAEV,OADA7B,EAAS,mDACF,EAGT,IAAK7B,IAAoBmF,EAEvB,OADAtD,EAAS,kCACF,EAGTqD,GAAgB,GAChBrD,EAAS,MAET,IACE,MAAMyE,QAAiB7C,OAAOC,SAASM,QAAQ,CAC7CC,OAAQ,wBAGV,GAAwB,IAApBqC,EAASC,OACX,MAAM,IAAI/M,MAAM,uDAGlB,MAAMsM,QAAmBrC,OAAOC,SAASM,QAAQ,CAAEC,OAAQ,gBACpC4B,SAASC,EAAY,MAErBT,SACf7B,EAAgBxD,GAGxB,MAAM+F,EAAkBC,EAAAA,mBAAmB,CACzCC,MAAOd,EACPe,UAAWC,EAAAA,OAAO1C,OAAOC,YAG3Be,EAAgBsB,GAChBlB,EAAWyB,EAAS,IACpBxB,EAAWO,GAEX,MAAMsB,EAAkBC,EAAAA,mBAAmB,CAAEX,MAAOd,EAAee,UAAWlD,EAAAA,SAC9E2B,EAAgBgC,GAChB,IACE,MAAM5B,QAAgB4B,EAAgBE,WAAW,CAAEjO,QAAS0N,EAAS,KACrEtB,EAAW8B,WAAW/B,GAAWgC,KAAKC,IAAI,GAAI,IAC/C,CAAC,MAAOhM,GACPD,QAAQC,MAAM,0BAA2BA,GACzCgK,EAAW,KACb,CAOA,OALAM,EAAyBc,QAAUC,EACnCb,EAAsBY,QAAUT,EAChClC,OAAOC,SAAS0D,GAAG,kBAAmBf,GACtC5C,OAAOC,SAAS0D,GAAG,eAAgBzB,IAE5B,CACR,CAAC,MAAOhD,GAGP,OAFA5H,QAAQC,MAAM,2BAA4B2H,GAC1Cd,EAASc,EAAI0B,UACN,CACT,CAAU,QACRa,GAAgB,EAClB,IACC,CAAClF,EAAiBmF,EAAeE,EAAiBgB,EAAuBV,IAEtE0B,EAAuB3B,EAAAA,aAAY3D,UACvC,KAAK0B,OAAOC,UAAa1D,GAAoBmF,GAAkBP,GAAS,CAGtE,OADA/C,EADiB,gDAEV,IACT,CAEA,IACE,MAAMiE,QAAmBrC,OAAOC,SAASM,QAAQ,CAAEC,OAAQ,gBAG3D,GAFuB4B,SAASC,EAAY,MAErBT,EAAiB,CACtCxD,EAAS,YACH2B,EAAgBxD,GACtB,MAAMsH,EAA0B,UAC1B,IAAIC,SAAQC,GAAWC,WAAWD,EAASF,KAEjD,MAAMI,QAAsBjE,OAAOC,SAASM,QAAQ,CAAEC,OAAQ,gBACxD2B,EAAaC,SAAS6B,EAAe,IAC3C,GAAI9B,IAAeP,EACjB,MAAM,IAAI7L,MAAM,wDAAwDoM,eAAwBP,IAEpG,CAEA,MAAMsC,EAAoB3B,EAAAA,mBAAmB,CAC3CC,MAAOd,EACPe,UAAWC,EAAAA,OAAO1C,OAAOC,YAM3B,OAHAe,EAAgBkD,GAChB7C,EAAWO,GACXxD,EAAS,MACF8F,CACR,CAAC,MAAOhF,GAEP,OADAd,EAASc,EAAI0B,SACN,IACT,IACC,CAACrE,EAAiBmF,EAAeE,EAAiBT,IAE/CgD,EAAiBrC,SAAOvF,GAyB9B,OAvBAM,EAAAA,WAAU,KACR,GAA+B,OAA3BsH,EAAexB,SACfwB,EAAexB,UAAYpG,GAC3B4E,IACFa,IACIhC,OAAOC,UAAU,CACnB,MAAM8C,EAAkBlB,EAAyBc,QAC3CK,EAAejB,EAAsBY,QACvCI,GACF/C,OAAOC,SAASgD,eAAe,kBAAmBF,GAEhDC,GACFhD,OAAOC,SAASgD,eAAe,eAAgBD,EAEnD,CAEFmB,EAAexB,QAAUpG,CAAe,GACvC,CAACA,EAAiB4E,EAASa,IAE9BnF,EAAAA,WAAU,KACR4G,GAAqB,GACpB,CAACA,IAGFtJ,EAAAC,cAAC0F,EAAchD,SAAQ,CACrBpE,MAAO,CACLqI,eACAE,eACAE,UACA1M,UACA6M,UACA/J,QACAiK,eACAkC,gBACAF,mBACAI,uBACAhC,oBAGDnH,EACsB,EC9RvB2J,EAAoBA,EAAGC,4BAC3B,MAAMlJ,gBACJA,EAAekB,cACfA,EAAaE,gBACbA,EAAenB,cACfA,EACAsB,mBAAoB4H,EAAyB3H,sBAC7CA,GACEQ,KAEEuG,cACJA,EAAavC,QACbA,EAAOJ,aACPA,EAAY6C,qBACZA,EAAoBpC,aACpBA,GDfqB+C,MACvB,MAAMnH,EAAUC,aAAWyC,GAC3B,IAAK1C,EACH,MAAM,IAAIrH,MAAM,kDAElB,OAAOqH,CAAO,ECWVmH,IAEG9F,EAAa+F,GAAkBlI,EAAQA,SAAC,OACxCmI,EAAQC,GAAapI,EAAQA,SAAC,OAC9BsE,EAAS+D,GAAcrI,EAAQA,SAAC,KAChCsI,EAAQC,GAAavI,EAAQA,SAAC,OAC9B/E,EAAO6G,GAAY9B,EAAQA,SAAC,MACuBA,EAAAA,UAAS,GAGnE,MAAOwI,EAAYC,GAAiBzI,EAAQA,UAAC,IACtC0I,EAAaC,GAAkB3I,EAAQA,UAAC,GAE/CO,EAAAA,WAAU,KACR6H,EAAU,MACVC,EAAW,IACXvG,EAAS,MACTyG,EAAU,MACVE,GAAc,EAAM,GACnB,CAACxI,EAAiBnB,IAErByB,EAAAA,WAAU,KACsByB,WAC5B,GAAK/B,GAAoBnB,EAEzB,IACE,MAAMS,EAAgBV,EAAgBW,2BAEhCpG,EADmB2G,EAAcT,mBACGhG,OAEpCsP,EAAiB,IAAI3P,EACzBsG,EAAcrH,IACdkB,SAGIwP,EAAepP,OACrB0O,EAAeU,GAEf,MAAMxG,EAAcvD,EAAgBwD,eAAevD,EAAcO,KACjE,IAAIwJ,EAAkB,KAEtB,IACIA,QAAwBD,EAAe/M,qBAAqBiN,OAAO1G,GACtE,CAAC,MAAO2G,GACL/N,QAAQC,MAAM,6BAA8B8N,EAChD,CAEA1I,EAAsB,CACpBkC,QAAStC,EACTU,MAAO7B,EAAcO,IACrBmD,YAAa1D,EAAcpG,OAC3B+D,OAAQ2F,GAAe,IACvBK,iBAAkB5D,EAAgB6D,sBAClCsG,YAAaH,KACVD,EAAe1N,yBAGhB2J,KACKzL,EAAiBX,UAAUG,UAAYiQ,EACvC/L,EAAe8L,EAAgB/D,EAASgE,EAAiBzP,EAAiBX,UAAUE,UAC9ES,EAAiBX,UAAUG,UACjC6P,GAAc,GAIxB,CAAC,MAAO7F,GACP5H,QAAQC,MAAM,kCAAmC2H,EACnD,GAGFqG,EAAuB,GACtB,CAAChJ,EAAiBnB,EAAeD,EAAiBgG,IAErD,MAAM/H,EAAiBkF,MAAOkH,EAAYC,EAAaC,EAAWzQ,KAC9D,IACI,MAAM0Q,EAAeC,EAAAA,WAAWR,OAAOM,GAAYzQ,GAC7C4Q,QAAqBL,EAAWvM,wBAAwBwM,EAAaE,GAC3EZ,EAAcc,EACjB,CAAC,MAAOC,GACLxO,QAAQC,MAAM,2BAA4BuO,EAC9C,GAqGJ,OACE3L,EAAAC,cAAA,MAAA,CAAKC,UAAWC,EAAOyL,mBACrB5L,EAAAC,cAAA,MAAA,CAAKC,UAAWC,EAAO0L,iBACrB7L,EAAAC,cAAA,OAAA,CAAMC,UAAWC,EAAO2L,kBAAkB,YAC1C9L,EAAAC,cAAA,OAAA,CAAMC,UAAWC,EAAO4L,kBAAmB5B,EAA0BzF,UAGvE1E,EAAAC,cAAA,MAAA,CAAKC,UAAWC,EAAO0L,iBACrB7L,EAAAC,cAAA,OAAA,CAAMC,UAAWC,EAAO2L,kBAAkB,YAC1C9L,EAAAC,cAAA,OAAA,CAAMC,UAAWC,EAAO4L,kBACrB5B,EAA0BgB,YACvB,GAAGhB,EAA0BgB,eAAehB,EAA0BtM,kBACtE,mBAIRmC,EAAAC,cAAA,SAAA,CAAQC,UAAWC,EAAO6L,aAAc5M,QAlHhB+E,gBACpBoF,GAAe,EAiHmD7F,SAAU2D,GAC7EA,EAAe,gBAAkBL,EAAU,cAAcA,EAAQiF,MAAM,EAAE,QAAU,kBAGrFjF,IAAYmD,EAA0BrM,oBAAsB6M,GAC1D3K,EAAAC,cAAA,SAAA,CAAQC,UAAWC,EAAO6L,aAAc5M,QAnHzB+E,UAClB,GAAKG,GAAgB0C,EAArB,CACA8D,GAAe,GACfN,EAAW,8BACX,IACI,MAAMW,YAAEA,EAAWpN,kBAAEA,GAAsBoM,EACrCvL,EAAS6M,EAAAA,WAAWR,OAAOE,GAAcpN,GAEzCmO,QAAoB5H,EAAY3F,iBAAiBqI,EAASpI,GAC1DmL,QAA0BN,IAE1B0C,QAAapC,EAAkBqC,gBAAgB,IAC/CF,EACHlF,YAGHwD,EAAW,+BAIc,mBADH5D,EAAayF,0BAA0B,CAAEF,UACjDG,QACR1B,GAAc,GACdJ,EAAW,8CAEXA,EAAW,2CAEjBM,GAAe,EAElB,CAAC,MAAMa,GACJxO,QAAQC,MAAMuO,GACd1H,EAAS0H,GACTnB,EAAW,sBACXM,GAAe,EACnB,CAhC8B,CAgC9B,EAkFmEpH,SAAUmH,GACtEA,EAAc,eAAiB,WAAWV,EAA0BtM,mBAI1EmJ,IAAYmD,EAA0BrM,mBAAqB6M,KAAgBL,GAC1EtK,EAAAC,cAAA,SAAA,CAAQC,UAAWC,EAAO6L,aAAc5M,QArFb+E,UAC/B,GAAK6C,GAAY1C,EAEjB,IACEiG,EAAU,MACVtG,EAAS,MACTuG,EAAW,8BAEX,MAAMW,YAAEA,EAAWvG,iBAAEA,EAAgB7G,kBAAEA,EAAiBD,kBAAEA,GAAsBqM,EAC1EoC,EAAed,EAAAA,WAAWR,OAAOE,GAAcpN,GAQ/CyO,EAAU,UANMlI,EAAYlG,eAChC4I,EACApC,EACA2H,GAG4BvF,QAASA,GAGnCwF,EAAQjO,MADRT,EACgByO,EAEA,GAGpBhC,EAAUiC,GACVhC,EAAW,4DACZ,CAAC,MAAOpN,GACP6G,EAAS7G,GACToN,EAAW,oCACb,IAuD+E,uBAK5ExD,GAAWsD,GACVtK,EAAAC,cAAA,SAAA,CAAQC,UAAWC,EAAO6L,aAAc5M,QA1DhB+E,UAC5B,IACE,IAAK6C,IAAYsD,EAAQ,OAEzB,MAAMP,QAA0BN,IAChCe,EAAW,4BAEX,MAAMC,QAAeV,EAAkBqC,gBAAgB9B,GAEvDI,EAAUD,GACVD,EAAW,uBAEPN,GACFA,EAAsB,CACpBO,SACA/F,QAAStC,EACTxD,OAAQuL,GAA2BvL,QAGxC,CAAC,MAAOxB,GACP6G,EAAS7G,GACToN,EAAW,wBACb,GAoC4E9G,SAAqB,OAAX+G,GAAiB,oBAKpGhE,GAAWzG,EAAAC,cAAA,MAAA,CAAKC,UAAU,eAAeuG,GAEzCgE,GACCzK,EAAAC,cAAA,MAAA,CAAKC,UAAWC,EAAOsM,iBAAiB,uBACfhC,EAAOwB,MAAM,EAAG,IAAI,OAG3C,EC/OJS,EAAgBA,EAAGnM,UAASoM,aAAYzC,4BAC5C,MAAMnH,gBAAEA,GAAoBC,IAO5B,OACEhD,EAAAC,cAACI,EAAM,CAACE,QANUqM,KAClB7J,IACAxC,GAAS,EAIqBlB,KAAMsN,GAClC3M,EAAAC,cAACmD,EAAiB,MAClBpD,EAAAC,cAAC6D,QACD9D,EAAAC,cAACgK,EAAiB,CAACC,sBAAuBA,IACnC,EAIP2C,EAAsBA,EAAGtM,UAASoM,aAAY3L,kBAAiBkJ,2BAEjElK,EAAAC,cAACgC,EAAe,CAACjB,gBAAiBA,GAChChB,EAAAC,cAAC0G,OACC3G,EAAAC,cAACyM,EAAa,CAACnM,QAASA,EAASoM,WAAYA,EAAYzC,sBAAuBA,YCpBtE,CAChB4C,gBCVK,MACLzR,WAAAA,CAAY0R,GACVvR,KAAKuR,eAAiBA,EACtBvR,KAAKwR,UAAYD,EAAeE,eAChCzR,KAAKqI,kBAAoBrI,KAAK0R,uBAC9B1R,KAAK4G,gBAAkB,IACzB,CAEA8K,oBAAAA,GACE,OAAOvJ,OAAOwJ,QAAQhT,GAAgBiT,QACpC,CAACC,GAAMxK,EAAYnB,MACZlG,KAAKwR,UAAUM,SAAS5L,EAAcpH,WACzC+S,EAAIxK,GAAcnB,GAEb2L,IAET,CACF,EACF,CAEAzK,aAAAA,CAAcC,GACZ,OAAmB,OAAfA,GACFrH,KAAK4G,gBAAkB,KACvBjF,QAAQoQ,IAAI,4BACL,GAEL/R,KAAKqI,kBAAkBhB,IACzBrH,KAAK4G,gBAAkBS,EACvB1F,QAAQoQ,IAAI,qBAAqB1K,MAC1B,IAET1F,QAAQC,MAAM,oBAAoByF,MAC3B,EACT,CAEAlB,wBAAAA,GACE,OAAOnG,KAAK4G,gBACR5G,KAAKqI,kBAAkBrI,KAAK4G,iBAC5B,IACN,CAEAyC,mBAAAA,GACE,OAAOrJ,KAAKuR,eAAelI,qBAC7B,CAGCL,cAAAA,CAAeE,EAASvD,GACvBhE,QAAQoQ,IAAI,8BAA+B7I,GAC3CvH,QAAQoQ,IAAI,kBAAmB/R,KAAKgS,SAEpC,OADchS,KAAKgS,QAAQ9I,KAAWvD,IAAa3F,KAAKgS,QAAQ9I,IAAU+I,aACzD,CACnB,GDxCArS,cACAsS,OEZK,MACLrS,WAAAA,CAAYsS,EAAU,IACpBnS,KAAKoJ,iBAAmB+I,EAAQ/I,kBAAoB,GACpDpJ,KAAKwR,UAAYW,EAAQX,WAAa,GACtCxR,KAAKgS,QAAUG,EAAQC,SAAW,CAAA,EAClCpS,KAAKqS,gBACP,CAEAA,cAAAA,GACE,IAAKrS,KAAKoJ,iBACR,MAAM,IAAIhJ,MAAM,iCAGlB,IAAK,MAAO8I,EAASoJ,KAAWnK,OAAOwJ,QAAQ3R,KAAKgS,SAAU,CAC5D,IAAKrT,EAAeuK,GAClB,MAAM,IAAI9I,MAAM,oBAAoB8I,KAEtC,IACGoJ,EAAOL,YACqB,iBAAtBK,EAAOL,YACdK,EAAOL,YAAc,EAErB,MAAM,IAAI7R,MAAM,yCAAyC8I,IAE7D,CACF,CAEAuI,YAAAA,GACE,OAAOzR,KAAKwR,SACd,CAEAnI,mBAAAA,GACE,OAAOrJ,KAAKoJ,gBACd,CAcAJ,cAAAA,CAAeE,GACbvH,QAAQoQ,IAAI,8BAA+B7I,GAC3CvH,QAAQoQ,IAAI,kBAAmB/R,KAAKgS,SAGpC,MAAM5O,EAASpD,KAAKgS,QAAQ9I,IAAU+I,WAGtC,OAFAtQ,QAAQoQ,IAAI,oBAAqB3O,GAE1BA,GAAU,CACnB,GF3CAmP,ODsBoBA,EAAG/M,kBAAiB2L,aAAa,SAAUzC,wBAAuB8D,gBACtF,MAAOC,EAAcC,GAAmB/L,EAAQA,UAAC,GAW3CgM,EAA4BjE,GAAyB8D,EAE3D,OACEhO,EAAAC,cAAA,MAAA,CAAKC,UAAWC,EAAOiO,kBACnBH,GACAjO,EAAAC,cAACd,EAAS,CAACC,QAdQiP,KACvBH,GAAgB,EAAK,EAaqB7O,KAAMsN,IAE7CsB,GACCjO,EAAAC,cAAC4M,EAAmB,CAClBtM,QAdkB+N,KACxBJ,GAAgB,EAAM,EAchBvB,WAAYA,EACZ3L,gBAAiBA,EACjBkJ,sBAAuBiE,IAGvB,EChDRhP,YACAkB,SACA+C"}